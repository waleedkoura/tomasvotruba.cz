<!DOCTYPE html>
<html lang="en">
    <head>
    <title>New in Symplify 5: 3 New Cool Features of PackageBuilder | Tomas Votruba</title>
    <meta charset="utf-8">
    <meta name="robots" content="index, follow">

        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    
    <link rel="alternate" type="application/rss+xml" title="Tomas Votruba Blog RSS" href="/rss.xml">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/solid.css" integrity="sha384-wnAC7ln+XN0UKdcPvJvtqIH3jOjs9pnKnq9qX68ImXvOGz2JuFoEiCjT8jyZQX2z" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/brands.css" integrity="sha384-nT8r1Kzllf71iZl81CdFzObMsaLOhqBU1JD2+XoAALbdtWaXDOlWOZTR4v1ktjPE" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/fontawesome.css" integrity="sha384-HbmWTHay9psM8qyzEKPc8odH4DsOuzdejtnr+OFtDmOcIVnhgReQ4GZBH7uwcjf6" crossorigin="anonymous">

        <link href="/assets/bootstrap/bootstrap.min.css?v=52071157" rel="stylesheet" type="text/css" />

    <link href="/assets/prism/prism.css?v=525346347" rel="stylesheet" type="text/css" />

        <link href="/assets/css/style.css?v=1141981506" rel="stylesheet" type="text/css" />

    <link href="/assets/gifplayer/gifplayer.css" rel="stylesheet" type="text/css" />

        <link href="/assets/css/checklist.css?v=1907982200" rel="stylesheet" type="text/css" />

    <script src="/assets/js/jquery-3.3.1.slim.min.js"></script>
    <script src="/assets/gifplayer/jquery.gifplayer.js"></script>
    <script src="/assets/js/checklist.js" async defer></script>
</head>
    <body>
        <!-- post_id: 145 -->

        <div class="hidden-sm-down">
    <nav class="navbar">
        <div class="container-fluid">
            <ul>
                <li id="logo">
                    <img src="https://avatars1.githubusercontent.com/u/924196?s=60&v=4" class="avatar">
                    Tomas Votruba
                </li>
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li class="">
                    <a href="/clusters/">Clusters</a>
                </li>
                <li class="">
                    <a href="/mission/">Mission</a>
                </li>
                <li class="">
                    <a href="/talks/">Talks</a>
                </li>
                <li class="">
                    <a href="/contact/">Contact</a>
                </li>
                <li id="top-menu-search">
                    <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction">
                        <meta itemprop="target" content="https://www.google.com/search?q={q}"/>
                        <input name="sitesearch" value="tomasvotruba.cz" type="hidden"/>
                        <input itemprop="query-input" type="text" id="search-query" class="form-control" required="required" name="q" placeholder="Search..." autocomplete="off"/>
                    </form>
                </li>
            </ul>
        </div>
    </nav>
</div>

<div class="hidden-md-up">
    <nav class="navbar" id="mobile-menu">
        <div class="container">
            <a href="/" class="col-3 col-sm-3 active">
                <em class="fas fa-book"></em>
                <br>
                PHP Blog
            </a>
            <a href="/clusters/" class="col-3 col-sm-3 ">
                <em class="fas fa-share-alt"></em>
                <br>
                Clusters
            </a>
            <a href="/mission/" class="col-3 col-sm-3 ">
                <em class="fas fa-heartbeat"></em>
                <br>
                Mission
            </a>
            <a href="/contact/" class="col-3 col-sm-3 ">
                <em class="fas fa-phone"></em>
                <br>
                Contact
            </a>
        </div>
    </nav>

    <div class="hidden-md-up text-center row" id="top-menu-search-mobile">
        <!-- inspired and taken from: https://github.com/yegor256/blog/blob/master/_layouts/default.html -->
        <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction" class="col-md-12">
            <meta itemprop="target" content="https://www.google.com/search?q={q}"/>
            <input name="sitesearch" value="tomasvotruba.cz" type="hidden"/>
            <input itemprop="query-input" type="text" id="search-query" class="form-control" required="required" name="q" placeholder="Search with Google..." autocomplete="off"/>
        </form>
    </div>
</div>

        <div class="mainContent">
            <div class="container-fluid" id="post">
                <h1 id="new-in-symplify-5-3-new-cool-features-of-packagebuilder"><a href="#new-in-symplify-5-3-new-cool-features-of-packagebuilder">New in Symplify 5: 3 New Cool Features of PackageBuilder</a></h1>

                <ul class="list-inline post-metadata">
    <li class="list-inline-item mr-3">
        <em class="fas fa-clock fa-fw"></em>
        <strong>4 min</strong>
    </li>

    <li class="list-inline-item mr-3">
        <em class="fas fa-calendar fa-fw"></em>
        <time datetime="2018-09-Thu">Thu, Sep 20, 2018</time>
    </li>

            <li class="list-inline-item mr-3">
            <em class="fas fa-fw fa-comments"></em>
            <a href="https://www.tomasvotruba.cz/blog/2018/09/20/new-in-symplify-5-3-new-cool-features-of-package-builder/#disqus_thread">X</a> comments
        </li>
    
            <li class="list-inline-item">
            <em class="fas fa-fw fa-edit"></em>
            <a href="https://github.com/TomasVotruba/tomasvotruba.cz/edit/master/source/_posts/2018/2018-09-20-new-in-symplify-5-3-new-cool-features-of-package-builder.md">Typo? Fix me, please</a>
        </li>
    
    </ul>

                
                
                <div class="card card-bigger">
                    <div class="card-body">
                        <a href="https://github.com/symplify/packagebuilder">PackageBuilder</a> was always sort of meta package with all <strong>the cool and shiny features anyone can use</strong>. After all, it's the most downloaded Symplify package hitting almost <a href="https://packagist.org/packages/symplify/package-builder/stats">1000 downloads a day</a>.
<br>
<br>
In Symplify 5 now it allows you to <strong>drop manual binds</strong> from Symfony configs, separate files from directories <strong>in one method</strong> and merge nested YAML parameters <strong>with 1&nbsp;service</strong>.
                    </div>
                </div>

                
                <p>You don't have this package installed yet?</p>
<pre><code class="language-bash">composer require symplify/package-builder</code></pre>
<p>Now enjoy the news â†“</p>
<h2 id="1-drop-manual-binds-in-symfony-configs"><a href="#1-drop-manual-binds-in-symfony-configs">1. Drop Manual Binds in Symfony configs</a></h2>
<p><a href="https://github.com/Symplify/Symplify/pull/998" class="btn btn-dark btn-sm">
<em class="fab fa-github fa-fw"></em>
See pull-request #998
</a></p>
<p>You can add <a href="https://symfony.com/blog/new-in-symfony-3-4-local-service-binding">parameter binding since Symfony 3.4</a>:</p>
<pre><code class="language-yaml">services:
    _defaults:
        bind:
            $meetupComApiKey: '%meetup_com_api_key%'</code></pre>
<p>That's nice. But what if you have multiple configs that use multiple parameters?</p>
<pre><code class="language-yaml">services:
    _defaults:
        bind:
            $meetupComApiKey: '%meetup_com_api_key%'
            $facebookApiKey: '%facebook_api_key%'
            $maxPostOnHomepage: '%max_post_on_homepage%'

    App\FirstPackage\:
        resource: ..</code></pre>
<pre><code class="language-yaml">services:
    _defaults:
        bind:
            $facebookApiKey: '%facebook_api_key%'
            $maxPostOnHomepage: '%max_post_on_homepage%'

    App\SecondPackage\:
        resource: ..</code></pre>
<h3 id="not-for-lazy-programmer"><a href="#not-for-lazy-programmer">Not for Lazy Programmer</a></h3>
<p>This way you'll be writing more bindings than there are parameters. And there is more! When you remove autodiscovered service that depends on a bound parameter, you'll get this &quot;nice&quot; exception:</p>
<blockquote class="blockquote">
    Unused binding "maxPostOnHomepage" in service "App\SomeUnterlatedService"
</blockquote>
<p>You can solve this all by having a huge config with all parameters, binding and services. Even if the config would be shorter than 100 lines, you still have to maintain parameters, bindings and services and it teaches other programmers to <em>put-everything-to-one-place</em> instead of SOLID principles.</p>
<p><br></p>
<p><strong>Would you like to get rid of this all extra maintenance, and just code cleanly instead?</strong> I would!</p>
<p>So, have you noticed the pattern?</p>
<ul>
<li><code>$variableName</code> &lt;=&gt; <code>%parameter_name</code></li>
<li><code>camelCase</code> &lt;=&gt; <code>underscore_case</code></li>
</ul>
<p>And exactly this can be automated! Just add <code>Symplify\PackageBuilder\DependencyInjection\CompilerPass\AutoBindParametersCompilerPass</code> compiler pass:</p>
<pre><code class="language-diff">&lt;?php

    // ...

 use Symfony\Component\DependencyInjection\ContainerBuilder;
 use Symfony\Component\HttpKernel\Kernel;
+use Symplify\PackageBuilder\DependencyInjection\CompilerPass\AutoBindParametersCompilerPass;

 final class YourAppKernel extends Kernel
 {
     // ...

+    protected function build(ContainerBuilder $containerBuilder): void
+    {
+        $containerBuilder-&gt;addCompilerPass(new AutoBindParametersCompilerPass());
+    }
 }</code></pre>
<p>And if you keep this convention, you can keep yours configs clear and minimalistic:</p>
<pre><code class="language-diff"> services:
-    _defaults:
-        bind:
-            $meetupComApiKey: '%meetup_com_api_key%'
-            $facebookApiKey: '%facebook_api_key%'
-            $maxPostOnHomepage: '%max_post_on_homepage%'</code></pre>
<p>Of course you can bind your parameters manually:</p>
<pre><code class="language-yaml">services:
    _defaults:
        bind:
            $anotherName: '%non_standard_parameter_naming%'

    SomeClass:
        arguments:
            - '%very_specfici_meetup_com_api_key%'</code></pre>
<h2 id="2-separate-files-from-directories"><a href="#2-separate-files-from-directories">2. Separate Files from Directories</a></h2>
<p><a href="https://github.com/Symplify/Symplify/pull/963" class="btn btn-dark btn-sm">
<em class="fab fa-github fa-fw"></em>
See pull-request #963
</a></p>
<p>Do you need to work multiple file/directories arguments?</p>
<pre><code class="language-bash">vendor/bin/ecs check src tests/ThisFile.php</code></pre>
<p>Just use <code>Symplify\PackageBuilder\FileSystem\FileSystem</code>:</p>
<pre><code class="language-php">&lt;?php

$sources = [
   __DIR__ . '/SomeDirectory',
   __DIR__ . '/SomeFile.php'
];

$symplifyFileSystem = new Symplify\PackageBuilder\FileSystem\FileSystem;
[$files, $directories] = $symplifyFileSystem-&gt;separateFilesAndDirectories($sources);

// ...</code></pre>
<h2 id="3-merge-parameters-without-leaving-any-behind"><a href="#3-merge-parameters-without-leaving-any-behind">3. Merge Parameters without Leaving Any Behind</a></h2>
<p><a href="https://github.com/Symplify/Symplify/pull/989" class="btn btn-dark btn-sm">
<em class="fab fa-github fa-fw"></em>
See pull-request #989
</a></p>
<p>At the moment, Symfony is unable to merge nested parameters <a href="https://github.com/symfony/symfony/issues/26713">for historical and other reasons</a>:</p>
<pre><code class="language-yaml"># config.yml
imports:
    - { resource: 'imported-file.yml' }

parameters:
    festivals:
        - three</code></pre>
<pre><code class="language-yaml"># imported-file.yml
parameters:
    festivals:
        - one
        - two</code></pre>
<p>This will end up with just 1 festival in classic Symfony Applicatoin. Do you want to use the <strong>full power of YAML, glob and imports</strong> and <strong>still keep all the parameters</strong>?</p>
<p>Use <code>Symplify\PackageBuilder\Yaml\ParameterMergingYamlLoader</code>:</p>
<pre><code class="language-php">&lt;?php

$parametersMergingYamlLoader = new Symplify\PackageBuilder\Yaml\ParameterMergingYamlLoader;
$parameterBag = $parametersMergingYamlLoader-&gt;loadParameterBagFromFile(
    __DIR__ . '/config.yml'
);

var_dump($parameterBag-&gt;get('festivals'));
// ['one', 'two', 'three']</code></pre>
<p><br></p>
<p>And that's all folks!</p>
<p><br></p>
<p>Happy tuning of your code!</p>

                <br>

                
                <div class="card mb-5">
                    <div class="card-body text-center">
                        <a href="https://github.com/TomasVotruba/tomasvotruba.cz/edit/master/source/_posts/2018/2018-09-20-new-in-symplify-5-3-new-cool-features-of-package-builder.md" class="btn btn-info btn-sm">
                            <em class="fas fa-fw fa-edit"></em>
                            Typo? Fix it, please
                        </a>
                        &nbsp;and join <a href="/thank-you">56 people</a> who build this website
                    </div>
                </div>

                <a name="comments"></a>

                <div id="disqus_thread"></div>

<script type="text/javascript">
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//' + 'itsworthsharing' + '.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
            </div>

            <script id="dsq-count-scr" src="https://itsworthsharing.disqus.com/count.js" async defer></script>
        </div>

        <script>
    ga=function(){ ga.q.push(arguments) };
    ga.q=[];
    ga.l=+new Date;
    ga('create', 'UA-46082345-1', 'auto');
    ga('send','pageview');
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>

<script src="/assets/prism/prism.js"></script>

<script>
    $('.gifplayer').gifplayer();
</script>

<div class="text-center mt-5" id="footer">
    <div class="row">
        <div class="col-12">
            Join 17 000 PHP developers every month: <a href="/rss.xml">RSS</a>&nbsp;or&nbsp;<a href="https://twitter.com/votrubaT">@votrubaT</a>

            <span class="pl-2 pr-2 hidden-sm-down">â€¢</span>

            <span class="hidden-sm-down">
                Watch my <a href="https://github.com/tomasvotruba">open-source addiction</a>
            </span>
        </div>
    </div>

    <p>
        Build by <a href="/thank-you/">56 people</a>

        <span class="pl-2 pr-2">â€¢</span>

        Runs on <a href="https://www.statie.org/">Statie</a>

        <span class="pl-2 pr-2">â€¢</span>

        <a href="/now/">Now</a>

        <span class="hidden-sm-down">
            <span class="pl-2 pr-2">â€¢</span>
            Hosted on <a href="https://github.com/tomasvotruba/tomasvotruba.cz">GitHub</a>
        </span>
    </p>
</div>
    </body>
</html>

        <meta property="og:type" content="article" />
    <meta property="og:title" content="New in Symplify 5: 3 New Cool Features of PackageBuilder" />
    <meta property="og:description" content="PackageBuilder was always sort of meta package with all the cool and shiny features anyone can use. After all, it&#039;s the most downloaded Symplify package hitting almost 1000 downloads a day.


In Symplify 5 now it allows you to drop manual binds from Symfony configs, separate files from directories in one method and merge nested YAML parameters with 1&amp;nbsp;service." />
    <meta property="og:url" content="https://www.tomasvotruba.cz/blog/2018/09/20/new-in-symplify-5-3-new-cool-features-of-package-builder" />

        <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@votrubaT">
    <meta name="twitter:title" content="New in Symplify 5: 3 New Cool Features of PackageBuilder" />
    <meta name="twitter:description" content="PackageBuilder was always sort of meta package with all the cool and shiny features anyone can use. After all, it&#039;s the most downloaded Symplify package hitting almost 1000 downloads a day.


In Symplify 5 now it allows you to drop manual binds from Symfony configs, separate files from directories in one method and merge nested YAML parameters with 1&amp;nbsp;service." />
