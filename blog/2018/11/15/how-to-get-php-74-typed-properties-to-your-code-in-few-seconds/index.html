<!DOCTYPE html>
<html lang="en">
    <head>
    <title>How to Get PHP 7.4 Typed Properties to Your Code in Few Seconds | Tomas Votruba</title>
    <meta charset="utf-8">
    <meta name="robots" content="index, follow">

        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    
    <link rel="alternate" type="application/rss+xml" title="Tomas Votruba Blog RSS" href="/rss.xml">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/solid.css" integrity="sha384-wnAC7ln+XN0UKdcPvJvtqIH3jOjs9pnKnq9qX68ImXvOGz2JuFoEiCjT8jyZQX2z" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/brands.css" integrity="sha384-nT8r1Kzllf71iZl81CdFzObMsaLOhqBU1JD2+XoAALbdtWaXDOlWOZTR4v1ktjPE" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/fontawesome.css" integrity="sha384-HbmWTHay9psM8qyzEKPc8odH4DsOuzdejtnr+OFtDmOcIVnhgReQ4GZBH7uwcjf6" crossorigin="anonymous">

        <link href="/assets/bootstrap/bootstrap.min.css?v=1956144019" rel="stylesheet" type="text/css" />

    <link href="/assets/prism/prism.css?v=214245340" rel="stylesheet" type="text/css" />

        <link href="/assets/css/style.css?v=150025788" rel="stylesheet" type="text/css" />

    <link href="/assets/gifplayer/gifplayer.css" rel="stylesheet" type="text/css" />

        <link href="/assets/css/checklist.css?v=860342565" rel="stylesheet" type="text/css" />

    <script src="/assets/js/jquery-3.3.1.slim.min.js"></script>
    <script src="/assets/gifplayer/jquery.gifplayer.js"></script>
    <script src="/assets/js/checklist.js" async defer></script>
</head>
    <body>
        <!-- post_id: 159 -->

        <div class="hidden-sm-down">
    <nav class="navbar">
        <div class="container-fluid">
            <ul>
                <li id="logo">
                    <img src="https://avatars1.githubusercontent.com/u/924196?s=60&v=4" class="avatar">
                    Tomas Votruba
                </li>
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li class="">
                    <a href="/clusters/">Clusters</a>
                </li>
                <li class="">
                    <a href="/mission/">Mission</a>
                </li>
                <li class="">
                    <a href="/talks/">Talks</a>
                </li>
                <li class="">
                    <a href="/contact/">Contact</a>
                </li>
                <li id="top-menu-search">
                    <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction">
                        <meta itemprop="target" content="https://www.google.com/search?q={q}"/>
                        <input name="sitesearch" value="tomasvotruba.cz" type="hidden"/>
                        <input itemprop="query-input" type="text" id="search-query" class="form-control" required="required" name="q" placeholder="Search..." autocomplete="off"/>
                    </form>
                </li>
            </ul>
        </div>
    </nav>
</div>

<div class="hidden-md-up">
    <nav class="navbar" id="mobile-menu">
        <div class="container">
            <a href="/" class="col-3 col-sm-3 active">
                <em class="fas fa-book"></em>
                <br>
                PHP Blog
            </a>
            <a href="/clusters/" class="col-3 col-sm-3 ">
                <em class="fas fa-share-alt"></em>
                <br>
                Clusters
            </a>
            <a href="/mission/" class="col-3 col-sm-3 ">
                <em class="fas fa-heartbeat"></em>
                <br>
                Mission
            </a>
            <a href="/contact/" class="col-3 col-sm-3 ">
                <em class="fas fa-phone"></em>
                <br>
                Contact
            </a>
        </div>
    </nav>

    <div class="hidden-md-up text-center row" id="top-menu-search-mobile">
        <!-- inspired and taken from: https://github.com/yegor256/blog/blob/master/_layouts/default.html -->
        <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction" class="col-md-12">
            <meta itemprop="target" content="https://www.google.com/search?q={q}"/>
            <input name="sitesearch" value="tomasvotruba.cz" type="hidden"/>
            <input itemprop="query-input" type="text" id="search-query" class="form-control" required="required" name="q" placeholder="Search with Google..." autocomplete="off"/>
        </form>
    </div>
</div>

        <div class="mainContent">
            <div class="container-fluid" id="post">
                <h1 id="how-to-get-php-7-4-typed-properties-to-your-code-in-few-seconds"><a href="#how-to-get-php-7-4-typed-properties-to-your-code-in-few-seconds">How to Get PHP 7.4 Typed Properties to Your Code in Few Seconds</a></h1>

                <ul class="list-inline post-metadata">
    <li class="list-inline-item mr-3">
        <em class="fas fa-clock fa-fw"></em>
        <strong>5 min</strong>
    </li>

    <li class="list-inline-item mr-3">
        <em class="fas fa-calendar fa-fw"></em>
        <time datetime="2018-11-Thu">Thu, Nov 15, 2018</time>
    </li>

            <li class="list-inline-item mr-3">
            <em class="fas fa-fw fa-comments"></em>
            <a href="https://www.tomasvotruba.cz/blog/2018/11/15/how-to-get-php-74-typed-properties-to-your-code-in-few-seconds/#disqus_thread">X</a> comments
        </li>
    
            <li class="list-inline-item">
            <em class="fas fa-fw fa-edit"></em>
            <a href="https://github.com/TomasVotruba/tomasvotruba.cz/edit/master/source/_posts/2018/2018-11-15-how-to-get-php-74-typed-properties-to-your-code-in-few-seconds.md">Typo? Fix me, please</a>
        </li>
    
    </ul>

                
                
                <div class="card card-bigger">
                    <div class="card-body">
                        PHP 5.6 and 7.0 is going to be dangerous <a href="http://php.net/supported-versions.php">since 2019</a>, PHP 7.1 is <a href="https://gophp71.org/">new baseline</a> and PHP 7.3 is just about to be released in the end of 2018.
<br><br>
Is this <strong>the best time to upgrade your code to PHP 7.4</strong>?
                    </div>
                </div>

                
                <p><strong>Probably not</strong>. Unless you're able to compile <a href="https://github.com/php/php-src/">PHP repository</a> yourself and live on the edge of the edges. PHP 7.4 can be the smoothest upgrade you've experienced. <strong>If you'll think about in your coding since today</strong>.</p>
<h2 id="can-code-var-code-annotations-be-really-useful"><a href="#can-code-var-code-annotations-be-really-useful">Can <code>@var</code> Annotations be Really Useful?</a></h2>
<p>Annotations were always in the bottom, ashamed and not considered a <em>real code</em>. They help us to guess the type of the property. Not only to us, but also to <a href="/blog/2018/10/22/brief-history-of-tools-watching-and-changing-your-php-code/#2-static-analysis-tools">static analysis tools</a>.</p>
<pre><code class="language-php">&lt;?php

final class SomeClass
{
   /**
    * @var int
    */
   private $count;
}</code></pre>
<p>Here we can see that <code>$count</code> is an <code>int</code> number.</p>
<p><strong>In PHP 7.4</strong> we could change this code to get a <a href="https://wiki.php.net/rfc/typed_properties_v2">strict typing</a>:</p>
<pre><code class="language-diff"> &lt;?php declare(strict_types=1);

 final class SomeClass
 {
-   /**
-    * @var int
-    */
-   private $count;
+   private int $count;
 }</code></pre>
<p>When you write <code>@var</code> annotation today, you'll be preparing your code for future refactoring. You might laugh now: &quot;everyone is doing that today, why do you even write about this obvious standard&quot;.</p>
<p>Well, not everyone...</p>
<div class="text-center">
    <img src="/assets/images/posts/2018/php74-typed/symfony-lacking.png" class="img-thumbnail"><p>This is my favorite class to extend in whole Symfony - a <a href="https://github.com/symfony/symfony/blob/dbf053bc854f6768ddcd8ed39f7cbb2c21e500e6/src/Symfony/Component/Console/Command/Command.php#L37-L51"><code>Command</code> class</a>.
</p></div>
<p>This is Symfony 4.2 (dev) we're talking about with PHP 7.1+. Lot's of Symfony code is <strike>weakly</strike> <em>not</em> typed, but that's not the biggest problem.</p>
<h2 id="quot-em-my-favorite-framework-em-uses-it-it-must-be-the-best-practise-in-php-quot"><a href="#quot-em-my-favorite-framework-em-uses-it-it-must-be-the-best-practise-in-php-quot">&quot;<em>My-favorite-framework</em> Uses It, It must be the Best Practise in PHP!&quot;</a></h2>
<p>The problem is <em>framework-way</em> approach to learning PHP. Many developers I've met <strong>think their framework uses the best practices of the PHP itself</strong>. Why? <strong>Have you ever tried to learn some other PHP framework than the one you're using today?</strong> I mean learn, not just try on the workshop, during the weekend, but to really build a big application with it.</p>
<p>Saying that, <strong>many developers adopt Symfony practices thinking <em>it the best form of PHP there is</em></strong>. There's no place to blame developers, it's just how society works - with <em>observational learning</em>. We should not blame Symfony either since there is no <em>code quality engineer</em>, who would push <em>non-feature</em> code changes. Unfortunately, Symfony team itself is strictly against these changes as you can see in PR comments.</p>
<p>Recently I'm very happy to see these engineers around me - <a href="https://www.lmc.eu">LMC</a> to name one for all.</p>
<h2 id="visualize-future-compatibility"><a href="#visualize-future-compatibility">Visualize Future Compatibility</a></h2>
<p>When you code, think about the way to write <strong><em>future compatible</em> code</strong>. What is happening in PHP for the last 2-3 years? Type hints, ?nullables, <code>void</code>, AST and static analysis suggest, there is more coming. I wouldn't be surprised if these annotations turn out to be useful in pure PHP one day:</p>
<pre><code class="language-php">&lt;?php

final class SomeClass
{
    /**
     * @var int
     */
    private const NUMBER = 5;

    /**
     * @var Product[]
     */
    private $products = [];
}</code></pre>
<p>In PHP 8 or 9 this might come:</p>
<pre><code class="language-diff"> &lt;?php declare(strict_types=1);

 final class SomeClass
 {
-    /**
-     * @var int
-     */
-    private const NUMBER = 5;
+    private const int NUMBER = 5;

-    /**
-     * @var Product[]
-     */
-    private $products = [];
+    private Product[] $products = [];
}</code></pre>
<p>In <a href="/blog/2018/10/18/how-i-almost-missed-my-talk-in-php-asia-conference/">PHP Asia</a>, <em>typed arrays</em> was the most desired feature in next versions of PHP. So were <em>typed properties</em> once and so were <em>strict types</em> before them. In 2015 we would only dream about those 2, now one is part of our every-day life, second coming soon.</p>
<h2 id="quot-in-seconds-quot"><a href="#quot-in-seconds-quot">&quot;...in Seconds&quot;</a></h2>
<p>Yeah, right, I made a promise - I'll get back to nearer future with <em>typed properties</em>.</p>
<p>Let's say we're thinking about the future and adding all <code>@var</code> annotations we can. Is that enough? You'd still have to do these diffs manually:</p>
<pre><code class="language-diff"> &lt;?php declare(strict_types=1);

 final class SomeClass
 {
-    /**
-     * @var boolean
-     */
-    public $a;
+    public bool $a;

     /**
-     * @var bool
      * another comment
      */
-    private $b = false;
+    private bool $b = false;

     /**
      * @var callable
      */
     private $c;

-    /**
-     * @var AnotherClass|null
-     */
-    private $d = null;
+    private ?AnotherClass $d = null;

     /**
      * @var int
      */
     public $e = 'string';
}</code></pre>
<p>Or you could <strong>be actually rewarded for your daunting <code>@var</code> work</strong>. Good news! Rector will do this one for you:</p>
<pre><code class="language-bash">composer require rector/rector --dev
vendor/bin/rector process src --level php74
# few seconds...
#
# Done!</code></pre>
<p>See <a href="https://github.com/rectorphp/rector/pull/643/">pull-request #643</a> to get more insight into how this very nice AST use case works.</p>
<p><br></p>
<p>I started this post to show how Rector helps with huge refactorings like <code>@var</code> annotations to types that are about to come next year. But the message is far being that - observing trends, seeing the future and working towards that.</p>
<h2 id="how-to-make-your-future-self-happy"><a href="#how-to-make-your-future-self-happy">How To Make Your Future-Self Happy?</a></h2>
<ul>
<li><strong>write <code>@var</code> above each property</strong></li>
<li>write <code>@var</code> or any other <code>@value</code> info <strong>above each constant</strong></li>
<li><strong>write <code>@var Type[]</code> above each array property</strong>
<ul>
<li>not <code>mixed</code>, not <code>object</code>, but scalar or specific class or interface</li>
</ul></li>
<li>think about rules in your code that you've <strong>non-critically copy-pasted from the framework</strong></li>
</ul>
<p>You're saving work to yourself, to your colleagues and to tools like Rector, that will do the work for you. If you're ready...</p>
<p><br></p>
<p>Do you have some own future compatibility tips you use in your code today? I'd love to hear them ↓</p>

                <br>

                
                <div class="card mb-5">
                    <div class="card-body text-center">
                        <a href="https://github.com/TomasVotruba/tomasvotruba.cz/edit/master/source/_posts/2018/2018-11-15-how-to-get-php-74-typed-properties-to-your-code-in-few-seconds.md" class="btn btn-info btn-sm">
                            <em class="fas fa-fw fa-edit"></em>
                            Typo? Fix it, please
                        </a>
                        &nbsp;and join <a href="/thank-you">56 people</a> who build this website
                    </div>
                </div>

                <a name="comments"></a>

                <div id="disqus_thread"></div>

<script type="text/javascript">
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//' + 'itsworthsharing' + '.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
            </div>

            <script id="dsq-count-scr" src="https://itsworthsharing.disqus.com/count.js" async defer></script>
        </div>

        <script>
    ga=function(){ ga.q.push(arguments) };
    ga.q=[];
    ga.l=+new Date;
    ga('create', 'UA-46082345-1', 'auto');
    ga('send','pageview');
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>

<script src="/assets/prism/prism.js"></script>

<script>
    $('.gifplayer').gifplayer();
</script>

<div class="text-center mt-5" id="footer">
    <div class="row">
        <div class="col-12">
            Join 17 000 PHP developers every month: <a href="/rss.xml">RSS</a>&nbsp;or&nbsp;<a href="https://twitter.com/votrubaT">@votrubaT</a>

            <span class="pl-2 pr-2 hidden-sm-down">•</span>

            <span class="hidden-sm-down">
                Watch my <a href="https://github.com/tomasvotruba">open-source addiction</a>
            </span>
        </div>
    </div>

    <p>
        Build by <a href="/thank-you/">56 people</a>

        <span class="pl-2 pr-2">•</span>

        Runs on <a href="https://www.statie.org/">Statie</a>

        <span class="pl-2 pr-2">•</span>

        <a href="/now/">Now</a>

        <span class="hidden-sm-down">
            <span class="pl-2 pr-2">•</span>
            Hosted on <a href="https://github.com/tomasvotruba/tomasvotruba.cz">GitHub</a>
        </span>
    </p>
</div>
    </body>
</html>

        <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Get PHP 7.4 Typed Properties to Your Code in Few Seconds" />
    <meta property="og:description" content="PHP 5.6 and 7.0 is going to be dangerous since 2019, PHP 7.1 is new baseline and PHP 7.3 is just about to be released in the end of 2018.

Is this the best time to upgrade your code to PHP 7.4?" />
    <meta property="og:url" content="https://www.tomasvotruba.cz/blog/2018/11/15/how-to-get-php-74-typed-properties-to-your-code-in-few-seconds" />

        <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@votrubaT">
    <meta name="twitter:title" content="How to Get PHP 7.4 Typed Properties to Your Code in Few Seconds" />
    <meta name="twitter:description" content="PHP 5.6 and 7.0 is going to be dangerous since 2019, PHP 7.1 is new baseline and PHP 7.3 is just about to be released in the end of 2018.

Is this the best time to upgrade your code to PHP 7.4?" />
